---
# title: "Alternate Stable States in Farming System Diversification: Effects of Land Tenure, Environmental Shocks, and Subsidy Structures" #original title
# title: "Tipping points in the adoption of sustainable agricultural practices: A coupled human and natural systems approach." #Carl's
title: "Getting over the hump: A coupled human and natural systems approach to the adoption of sustainable agricultural practices." #Serge's
author:
  - name: Melissa Chapman
    affiliation: espm
  - name: Serge Wiltshire
    affiliation: espm
  - name: Timothy Bowles
    affiliation: espm
  - name: Claire Kremen
    affiliation: espm
  - name: Kathryn De Master
    affiliation: espm
  - name: "...others in group"
    affiliation: espm
  - name: Carl Boettiger
    affiliation: espm
    footnote: Corresponding Author
address:
  - code: espm
    address: "Dept of Environmental Science, Policy, and Management, University of California Berkeley, Berkeley CA 94720-3114, USA"
  - code: ubc
    address: "University of British Columbia"
abstract: |
keywords:
  - diversified practices,
  - ecosystem services
bibliography: alt_stable_states.bib
date: "`r Sys.Date()`"
output: rticles::elsevier_article
layout: 3p # review # review = doublespace, 3p = singlespace, 5p = two-column
header-includes: 
  - \journal{TBD}
  - \graphicspath{{figs/}}
  - \usepackage{float}

---


```{r setup, message=FALSE, echo=FALSE}
rm(list = ls(all.names = TRUE))
knitr::opts_chunk$set(echo = FALSE,
                      cache = TRUE,
                      message = FALSE,
                      warning = FALSE,
                      fig.width=7,
                      fig.height=3.5,
                      fig.align = "center")
library(tidyverse)
library(MDPtoolbox)
library(mdplearning)
source("../R/continuous-model.R")
set.seed(4)
```


```{r figure_setup, include = FALSE}
library(ggplot2)
library(hrbrthemes)
library(Cairo)
library(extrafont)
extrafont::loadfonts()
ggplot2::theme_set(hrbrthemes::theme_ipsum_rc())

library(ggthemes)
library(ggpubr)
library(patchwork) # devtools::install_github("thomasp85/patchwork")
library(ggtext) # install cli, gh, devtools::install_github("clauswilke/ggtext")
pal <- solarized_pal()(7)
scale_colour_discrete <- function(...) scale_colour_solarized()
scale_fill_discrete <- function(...) scale_fill_solarized()

## hrbrthemes needs cairo_pdf device
knitr::opts_chunk$set(dev = "cairo_pdf")

```

```{r model_def, include = FALSE}
actions <- seq(0, 1, length = 100)
# Allow max(state) > max(actions) to avoid creating a hard boundary on ecosystem state
states <- seq(0, 1.5, length = 100)
params <- list(benefit = 1.57, cost = 1, sigma = 0.1, r = .1)
discount <- 0.97
transition_fn <- function(s, a, params) s + params$r * (a - s)
utility_fn <- function(s,a, params) params$benefit * s - params$cost * a
model <- continuous_model(states, actions, params, transition_fn, utility_fn)
```

```{r model_run, include = FALSE}
soln <- MDPtoolbox::mdp_value_iteration(model$P, model$U, discount)
soln_df <- tibble(state = states,
                  action = actions[soln$policy])
#write_csv(soln_df, "../data/soln_df.csv.gz")
```



<!-- MANUSCRIPT START -->

\section{Introduction}

In recent years, scholars have increasingly recognized that solutions to complex ecological policy issues often require an interdisciplinary approach, conceiving human decisionmaking and ecology as a tightly-enmeshed social-ecological system (SES) or coupled human and natural system (CHANS).  SES/CHANS analysis is appropriate wherever human agents make choices that impact the environment, and the resultant environmental change creates complex feedback loops that impinge upon the scope and efficacy of the human agent's future decisions \cite{ostrom2009general, walker2004resilience, liu2007complexity}.  Agriculture---being among the most fundamental drivers of anthropogenic ecological change \cite{stoate2009ecological}---represents a critical focus area to examine the core dynamical properties inherent to such human-environment nexuses.  While agriculture is often studied through a discipline-specific lens, in reality growers' management decisions---in particular those which promote functional biodiversity---have profound and complex effects on their local ecology, with these agronomic outcomes in turn embuing ecological services (ES) that affect the long-term productive capacity of their land base, and their resultant financial returns \cite{zhang2007ecosystem}.  

This study presents a Markov Decision Process (MDP) model \cite{clark1989bioeconomic} that explores produce production in the central coast region of California through an SES framework.  We focus on Diversified Farming Systems (DFS), whose adherents employ practices to promote beneficial biodiversity that enhances productivity in the long term \cite{kremen2012diversified}.  Through a series of computational model experiments, we identify a mechanism that leads to a bimodal distribution of DFS adoption.  Specifically, we suggest that the path-dependency arising from a series of management decisions over time tends to drive behavior toward one of two extremes: virtually no adoption of DEPs, resulting in short-term economic efficiency advantages; versus sustained adoption of DEPs, leading to the long-term accural of ecological services.  In a series of experiments, we investigate the extent to which key decision factors drive behavior toward or away from DFS, finding that longer-term land tenure and sustained subsidy incentives may be important to promote DFS adoption.  
<!-- add "higher risk of environmental shocks" if we decide to include -->

\subsection{Diversified farming systems}

It has been widely observed that farms often fall into two general categories: small-to-medium operations that tend to sell into local, direct markets and take a longer view on sustainability; versus large monocropping operations that sell into the global commodities market and focus on short-term economic efficiency \cite{lyson2004commodity, lyson2008food}.  While attempts to understand the mechanisms behind this bifurcation into "civic" and "industrial" agriculture are not new, the situation remains complex \cite{ipes2018breaking}.  It is hypothesized that "civic" farmers benefit from the ES that flow from agrienvironmental practices, reducing the need for external inputs, curbing negative externalities, and increasing positive externalities, all of which have potential benefits, either directly or from public policy incentives \cite{kremen2012diversified}.  Meanwhile, "commodity" farmers, while more reliant on purchased inputs for fertility and pest control, are often larger, and derive their profits from higher per-annum revenue.

While DFS can bolster ecosystem services, the cost-benefit analysis of DEP adoption can be uncertain.  Practices to reduce topsoil loss and harmful runoff such as riparian buffers and hedgerows---often subsidized by government agencies like NRCS---present tradeoffs between payout and opportunity cost over time \cite{rein1999economic}.  Increasing crop rotational diversity requires built knowledge, reliable markets, and specialized equipment \cite{carlisle2014diversity}.  Further, if an ecosystem starts in a degraded state---for instance after decades of intensive monocultural cultivation and agrochemical input application---ecosystem restoration can be a slow process.  Increasing soil organic matter---crucial for nutrient and water cycling and retention---through compost application, crop rotation, or cover cropping can take years or even decades.  Rebuilding insect communities for pollination and pest control through perennial plantings or intercropping is similarly slow.  The uncertainty and/or lag time required to implement DEPs is a fundamental challenge of transitioning to DFS, since growers incur known costs in the short-term but long-term benefits are less clear.  Hence, it may be hypothesized that farmers in the simplified, monocultural state tend to remain there, because of strong path dependency and the big leap needed to transition successfully to DFS.

\subsection{Complexity and CHANS modeling}

Recent research in complexity theory reveals the importance of understanding nonlinear behaviors within dynamical systems.  For example, when pushed beyond some threshold, or tipping point, a system may enter a virtually-irreversible state, driving its behavior into divergent "basins of attraction," even given potent countervailing actions on the part of a decision-maker \cite{bar2019dynamics}.  These types of complex dynamics have been observed empirically across a wide variety of SESs, such that the identification of effective policy measures to effect change in these areas have been described as "wicked problems" that often confound traditional methods of analysis \cite{head2008wicked}.  As such, computational methods have begun to emerge as the go-to tools to study problems in the CHANS domain, typically involving the development of stylized computer models to identify features such as alternate equilibria and levers of change that affect dynamical behavior \cite{ostrom2009general}.  

While SESs like wildlife and fisheries management have been extensively studied in this way \cite{crowder2008impacts}, much of the research on agriculture has continued to revolve around unidisciplinary approaches, for example viewing food production through an economic commodity lens, or using natural science methods to develop new plant breeds or assess ecological outcomes like water contamination \cite{francis2008transdisciplinary}.  In recent decades, scholars have increasingly recognized the potential for wicked problems in agriculture to be illuminated by conceiving of agricultural systems as CHANS.  For example, using a simple SES computer model encompasing feedbacks between cultivation intensity, yield, and market price over time, \cite{vandermeer1997syndromes, vandermeer2012syndromes} identify a mechanism by which two "syndromes" may emerge within an agricultural marketplace, one defined by high prices, high intensity, and volatility; and the other by lower-prices, lower-intensity, and market stability. Many of the dynamical features found in other SES domains---including tipping points, periodic oscillations, and chaotic behavior---were observed.  While fundamentally rooted within a microeconomic paradigm, this study was among the first to identify a mechanism to explain complex dynamical behavior within agriculture as a CHANS.  Computational methods like agent-based modeling, network analytics, and machine learning have also been employed to discover new insights into livestock disease spread \cite{wiltshire2018using, wiltshire2019network}, {>>complete list<<}...

Through a CHANS lens, we hypothesize that the empirically-observed bifurcation in agricultural DFS adoption may be the result of complex tipping point dynamics, leading to two distinct stable states into which farmers are often drawn.  We view the adoption of agricultural diversification practices as a CHANS within which farmers must weigh uncertain tradeoffs between short- vs. long-term economic costs and benefits, and downstream ecological outcomes which may feed back to influence future productivity.  Based on existing observations and our own social-ecological data, we develop a Markov Decision Process (MDP) model to explore these complexities.  

MDP models help us understand the likely results of sequential decisions over time in contexts where outcomes are uncertain.  Stochastic Dynamic Programming (SDP) is the technical means by which we determine the optimum set of actions, i.e. “solve” an MDP model.  A utility function defines how good each solution is for the agent (or decision-maker), in terms of financial rewards, social rewards, or whatever utility metric fits the situation \cite{marescot2013complex}.  The decision-maker must make a series of decisions, adapting to the somewhat-random fluctuations associated with the natural system to make the best decision possible given the information available \cite{marescot2013complex}.  

The MDP approach has proven especially useful to model CHANS, such as public policy surrounding forest management, pest and disease spread, water management, and fisheries \cite{marescot2013complex, clark1989bioeconomic}.  MDPs have also seen limited application within agricultural decision-making, for example as agronomic decision-support tools \cite{kristensen2003general} or to understand livestock epidemic spread \cite{peyrard2007graph}.  Our model is the first to leverage an MDP to explore the social-ecological factors that underpin adoption of pro-environmental agricultural practices {>>is this a fair analysis?<<}.  

<!-- From proposal: By establishing MDP models as the basis of a conceptual framework for studying agricultural socio-ecological systems, we will help to build a rigorous theoretical basis for the application of CHANS to agricultural systems. The project will fill a key gap in agricultural social science and policy18 by studying the interacting effects of government policies, agri-conservation incentive programs, and supply chain/industry actor requirements on farmers’ ability and willingness to take up diversification practices. The project will also contribute to filling an important gap in the field of ecology by studying novel relationships between biodiversity, ecosystem functions, and ecosystem services and disservices in real-world management systems29,30. Specifically, we will assess how community composition of birds and soil microbes jointly influence food safety through the incidence and suppression of foodborne pathogens, and how soil microbial community composition affects soil functions and soil-based ecosystem services that affect farm sustainability. The integrated CHANS perspective will increase scientific understanding of the potential synergies and tradeoffs of how diversified farming practices affect biodiversity, ecosystem services, short-term profitability, and long-term sustainability. The decision support tool we prototype will make a lasting contribution to guide farmers and policymakers in making more informed choices that take into account the impact of a variety of potentially conflicting variables and influences.  -->

\section{Results}

\subsection{Bimodal DEP adoption distribution}

Fig \ref{fig:res_policy} shows the policy $\pi$, or optimal course of action, for an agent in the model under base-case conditions, caluclated using backward-induction \cite{bellman1957markovian}.  We find a critical bifurcation, or tipping point, at an ecosystem state of $S \approx 0.48$, below which the highest expected value is derived by investing virtually-nothing into DEPs.  Above the threshold, the optimum action becomes near-full investment into DEPs, up until $S \approx 1.35$, at which point further investments begin to exhibit diminishing returns.  

```{r res_policy, fig.cap = "Optimal decision policy $\\pi$ as a function of ecosystem state."}
# ggplot(soln_df, aes(state,action)) +
# geom_point(size = 1) +
# geom_vline(xintercept = .477, linetype="dashed", color = "red", size=.7) +
# annotate('label', x = .55, y = .35, label = ".48", hjust = 0, vjust = .5,
#          family = "Roboto Condensed", size = 3.25, label.padding = unit(.15, "lines"), label.size = 0, alpha = .8) +
# annotate("segment", x = .55, xend = .49, y = .35, yend = .35, size=.5, arrow=arrow(length = unit(0.22, "cm"))) +
# labs(x="ES state", y="Optimal action") +
# scale_x_continuous(limits = c(0,1.5), expand = c(.01,.01)) +
# scale_y_continuous(limits = c(0,1), expand = c(.01,.01)) +
# theme(axis.text.x=element_text(size=10),
#       axis.text.y=element_text(size=10),
#       axis.title.x=element_text(size=10),
#       axis.title.y=element_text(size=10),
#       panel.grid.minor = element_blank(),
#       plot.margin=grid::unit(c(5,5,5,5), "mm"))

# BWE for troubleshooting
ggplot(soln_df, aes(state,action)) +
geom_point(size = 1) 

```

<!-- 
\begin{figure}[H]
	\centering
	\includegraphics[width=.75\textwidth]{fig_policy.pdf}
	\caption{Optimal decision policy $\pi$ as a function of ecosystem state.}
	\label{fig:res_policy}
\end{figure}
-->

Fig \ref{fig:res_bimodal} shows the simulation results from 500 model repetitions.  Agents' initial ecosystem states are distributed normally with a mean at $\bar{S} = 0.5$.  After having followed policy $\pi$ for nine timesteps, at $t = 10$ we find that agents have largely bifurcated into two groups, with farms in the "simplified" class centered around $S = 0.17$, and those in the "diversified" class around $S = 0.82$.  Further, we find strong path dependency, with only 11\% of runs which started in a simplified ($S < 0.5$) state concluding in a diversified ($S > 0.5$) state, and only 7\% of runs initially in the diversified state transitioning to simplified.  

\begin{figure}[H]
	\centering
	\includegraphics[width=\textwidth]{fig_bimodal.pdf}
	\caption{Simulations of 500 model agents over ten farming seasons.  Initial ES states follow a truncated normal distribution (mean = 0.5; S.D. = 0.2; truncated at [0,1]).  Agents utilize decision policy $\pi$ as shown in Fig \ref{fig:res_policy} for nine timesteps.  Right plot shows initial distribution (dark blue) and bimodal density distribution at $t = 10$ (light blue), with peaks annotated.}
	\label{fig:res_bimodal}
\end{figure}


\subsection{Land tenure}

Many agrienvironmental practices require upfront investment, but can pay for themselves over time through accrued ecosystem services.  For example, in California's Sacramento Valley, researchers calculated that an average farmer would recoup the investment of planting a hedgerow in seven years due to increased pollination services \cite{long2017hedgerow}.  However, such an investment is only wise if the grower is confident they will continue farming at their present location, for example if they own the land or have a sufficiently long-term lease.  With 39\% of U.S. farmland under lease (!!USDA NASS 2016 find citation!!), and with widely-varying rental agreements, the impact of land tenure on best-managment-practice adoption has been increasingly examined.  For example, a study of U.S. corn producers found that cash renters were less likely than land owners to implement grassed waterways, strip cropping, contour farming, or conservation tillage \cite{soule2000land}.  A study conducted in British Columbia found that tenant farmers planted fewer perennial crops than land owners \cite{fraser2004land}.  Our own ongoing research with lettuce farmers in California's Salinas Valley---discussed in more detail in the methods section---suggests that land tenure is an important factor in decisions about cover cropping and crop rotation.  In addition, investments in diversified farming practices may require access to credit, which often also hinges on secure land tenure as a form of collateral \cite{richardson2015land}.

Using the same simulation parameters as outlined in the previous section, we solve the MDP on a finite, two-year time horizon, representing the shorter window within which many tenant farmers may make decisions.  Comparing Fig \ref{fig:res_tenure} to Fig \ref{fig:res_bimodal} above shows that, as length of land tenure and/or stability of lease agreements decline---and thus optimal decisions are calculated more myopically---farmers are incentivized to severely limit investment into DEPs.  This results in a degredation of ecosystem state even among those plots with an initially high value, with 92\% of farmers ending up in the simplified state.  

\begin{figure}[H]
	\centering
	\includegraphics[width=\textwidth]{fig_short_tenure.pdf}
	\caption{Result of short land tenure on DEP adoption.  The simulation is identical to that in Fig \ref{fig:res_bimodal}, but the MDP is solved under a finite, two-year time horizon.}
	\label{fig:res_tenure}
\end{figure}

<!-- probably not needed, but we could recreate a similar figure if desired 
\begin{figure}
	\centering
	\includegraphics[width=\textwidth]{results_tenure_2.png}
	\caption{Tenure impacts the location of tipping point to high ecosystem states...}
	\label{fig:res_tenure_2}
\end{figure}
-->


\subsection{Subsidy structures}

Agricultural subsidies have become an integral part of farming over the past half-century, and policymakers are continually called upon to weigh farm viability against food affordability and environmental sustainability {>>cite farm bill, etc.<<}.  In recent years, climate change, soil degradation, and water use/quality considerations have increasingly pressured agricultural policy optimization {>>cite<<}.  Some have suggested that large, short-term subsidies may be more efficacious in nudging farmers toward management systems that effectively weigh these tradeoffs, while others are proponents of long-term, yet smaller subsidies {>>cite<<}.  Here we apply the DFS-MDP model to investigate this question in silico.  

Using the same initial setup as described above, we implement two competing subsidy structures: a short-term (two-year) subsidy which completely covers the cost of transitioning to a more diversified state, versus a longer-term (ten-year) subsidy which only marginally offests the transition cost.  Formally, the cost of each subsidy package to the issuing organization (i.e. the government or taxpayer) is equal, and in fact the short-term subsidy is technically more valuable if economic discounting is applied {>>cite the concept of discounting<<}.  Within the model, agents adapt their decision policy $\pi$ during the subsidy period, and at its conclusion they revent to base case (i.e. subsidy-free) decision rules.  

Fig \ref{fig:res_subsidy} shows that longer, more sustained subsidies may be more beneficial to nudge behavior over the critical threshold toward more sustainable systems in the long term.  Comparing these experimental results to those in Fig \ref{fig:res_bimodal}, we find that both subsidy packages were effective in shifting farmers to a sustained higher ecosystem-services state.  However, the sustained subsidy was much more effective at moving the needle.  Due to the previously-discussed "tipping point" dynamic inherent in the model, once an agent has crossed the threshold to the diversified state, it becomes much less likely that they will fall back toward the "simplified" state, at least in the short term.  With state-transition stochasticity a major factor in a given model run (as it is in the real world), longer-term subsidy packages have a higher chance of nudging behavior beyond the critical threshold.  

\begin{figure}[H]
	\centering
	\includegraphics[width=\textwidth]{fig_subsidy.pdf}
	\caption{Replicate simulations from 500 normally-distributed starting states (mean = 0.5; S.D. = 0.2; truncated at [0,1]) over 20 timesteps.  Panel A shows the effects of a large, abrupt subsidy (no direct cost to adoption during the initial two years).  Panel B simulates a smaller, yet more sustained subsidy (adoption cost = 0.9 during the first 10 years).  Ingoring discounting, subsidies have the same total cost to the issuing organization.  After subsidy is removed, agents adjust their decision rule to that of the base case (i.e. no subsidy).}
	\label{fig:res_subsidy}
\end{figure}





\subsection{System shocks}

{>>This whole section needs reworking, including new experiments and figures.  We need to decide whether it is necessary for this paper, based on its current length.<<}

Empirical system suggest that farmers’ response to perceived risk of shocks may have a bimodal distribution as well: that is, diversified farmers will invest more in biodiversity to buffer against shocks because they see this as a less risky strategy, while farmers in the simplified state may actually see transition to diversification as a more risky approach if they perceive a possibility of shocks like drought or market disruptions along the path that they cannot adapt to. (Fig \ref{fig:res_shock_1})

\begin{figure}[H]
	\centering
	\includegraphics[width=\textwidth]{results_shock_1.png}
	\caption{Impact of shocks to mean system dynamics and bistability (A) Both shock probability and belief in that probability are set equal. In the case where high ecosystem states increase resilience to shocks (or decrease the intensity of state shift due to shock) bistability remains. Otherwise, system state degrades to lower ecosystem state. It may be reasonable to assume Farmers that believe that diversified practice do not reduce the impact of shocks (or even increase risk of certain shocks, such as pathogen outbreak, may follow the trajectory as is a high ecosystem state does not reduce impacts. The bistability is not an artifact of the shock itself, but rather the belief of shocks and their corresponding risk factors and probabilities, which impact the optimal policy.}
	\label{fig:res_shock_1}
\end{figure}


<!-- 
fear or belief in shock as in the case of food bourne illness can lead to loss of diversified farming states and can have am even large effect than the shock itself. This suggest long-term, long lasting, lock-ins to low diversity states, despite benefits and increase resistance to shocks. 


!!Say something about (Fig \ref{fig:res_shock_2})...or remove it?!!

\begin{figure}[H]
	\centering
	\includegraphics[width=\textwidth]{results_shock_2.png}
	\caption{!!!Figure is not showing up correctly.  Need to investigate this!!!  Diminishing returns can provide mechanisms for reducing biomaditly and adoption of DP to the point where they become self sustaining. This could be in the form of providing technical assistance etc. However, would need to be provided for a significant amount of time to be worth it, and runs the risk of reducing the upper lock-in. Synergistic policies may create a quicker option for decreasing the barrier to entry, however, still provide mechanisms for bistability and may not support farmers are the lowest ecosystem states. However, synergistic solutions may not have unintended consequences of decreasing the upper optimal equilibrium point. .}
	\label{fig:res_shock_2}
\end{figure}
-->



\section{Discussion}

The DFS-MDP we present here represents a simplified and stylized version of the coupled human decision factors and ecological ramifications of diversification practice adoption among California produce growers.  While the concept of alternate stable states---or basins of attraction---and tipping points within agricultural SESs has been previously explored \cite{vandermeer2012syndromes}, our experimental results cast light on several core mechanisms that help to explain these complex dynamical behaviors, suggesting novel considerations as policymakers work to enhance the sustanability and resilience of agricultural production systems.  

In light of historical agricultural catastrophes like the dust bowl, scholars have increasingly called for swift action around modern-day stressors like climate change, soil degradation, water quality, and biodiversity loss.  Policymakers have responded by developing programs which offer incentives and support for agriecological practice adoption, yet designing efective policies has proven challenging.  Recent case studies---spanning decades, continents, and agricultural products---emphasize that policy mechanisms designed to promote agricultural sustainability have complex ramifications across various contexts \cite{ipes2018breaking}.  Understanding how to realize transitions to resilient management practices, while also maintaining an adequate food supply, remains an active area of study.  Critical to designing incentives is an understanding of the thresholds which render a given management practice viable to one farmer while nonviable to another.  Studying the decision factors that give rise to these thresholds is the only way for policymakers to develop effective levers to nudge management choices toward a model that is both financially and environmentally sustainable.  

While it is often assumed that farmers who adopt pro-environmental practices are motivated primarily by ethical beliefs about the long-term health of our planet, we present a model within which ecological benefits are accrued at the level of the individual farmer.  We find that, even where farmers are acting out of self-interest, investment in diversification practices can pay off.  However, it is well known that many practices that increase functional ecosystem services can take several years before significant beneficial effects are realized \cite{carlisle2014diversity, long2017hedgerow}.  Within the model, we find a threshold such that agents on each side of a tipping point tend to be drawn to one of two alternate stable states, one being more simplfied, and the other more diversified.  This leads to path dependency, whereby a farmer who begins with degraded land is incentivized to transition even more toward the simplified state, whereas a farmer who begins with well-cared-for, fertile land is incentivized to adopt management practices that maintain and improve functional diversification.  Given this finding, we suggest that a key lever of change for policymakers interested in promoting adoption of agrienvironmental practices may be to increasingly focus on supporting farmers' transitions within the critical window from the simplified to the diversified state by opening space for viable intermediate states.  

Under this view, binary certifications like the organic standard may be critiqued in some respects.  Although organic systems often use diversification practices, rules governing organic agriculture stipulate allowable inputs rather than strategic management of biodiversity; and producers are either certified or not, even if the ways in which farmers implement organic agriculture is quite heterogeneous \cite{shennan2017organic}.  An increasing focus on adoption of individual practices, rather than a cut and dried standard, may allow for a process of incremental transition, with farmers embedded in monocultural agricultural systems able to move stepwise toward DFS adoption.

To drill deeper into potential policy implications, we model the potential impact of land tenure on the adoption choice.  Growers who either own land or have a long lease agreement are incentivized to invest more in the long-term productive capacity of their land, which can result in adoption of agrienvironmental practices that have an upfront cost, yet pay out over longer time horizons.  Experimentation with DFS-MDP shows that, if farmers maximize their expected value on only a two-year time horizon, there is a strong incentive to maximize short-term profits by disinvesting in DEPs.  Whereas in the long-tenure base case 48\% of farmers end up in a low ecosystem-services state, under the short land tenure scenario 92\% of farmers end up in this simplified state.  This suggests that a focus on expanding financing for new farmers to purchase land and/or legislating minimum lease durations for agricultural land rentals may be possible levers by which to increase adoption of agriecological practices.  Another related consideration is farmers' succession plans: with the average age of landholding farmers continuing to increase, and with succession plans often uncertain {>>cite<<}, it is likely that even more agricultural land may be leased in the coming years if this issue is not addressed.  

Subsidies are a fundamental part of modern U.S. agricultural policy, be it through direct payments, or, under more recent farm bills, heavy subsidization of crop insurance premiums.  Our subsidy experiment shows that---all else being equal---a given quantity of taxpayer funding devoted to diversification practices will more-effectively move the needle if it is guaranteed over a longer period rather than being offered as a lump sum.  Specifically, we find that a sustained subsidy was successful in moving 43\% of farmers who started in the simplified state to the diversified state, whereas the figure was only 24\% for the abrupt subsidy.  A ramification of this finding is that the perceived stability of suibsidy programs may be important in promoting agrienvironmental practice adoption.  Since, as we have seen, the transitional "hump" between the two stable states represents a precarious economic position, if a subsidy is not guaranteed for a long enough period to get over the hump toward DFS, the rational farmer will be incentivized to simply continue in their simplified state.  With U.S. farm bills being completely overhauled every five years or so, a farmer may have limited confidence that a critical subsidy program will be sufficiently long-lived, suggesting that a policy lever may be to prolong the sunsetting of any new agrienvironmental subsidy.  

<!-- Shocks: maybe, maybe not!  While we believe the diversified state can self-sustain to some extent, we caution against the assumption that farmers may find their own way there in the face of shocks like climate change and market disruptions that act to force change. We suggest that farmers response to perceived risk of shocks may have a bimodal distribution as well: that is, diversified farmers will invest more in biodiversity to buffer against shocks, while farmers in the simplified state may actually see transition to diversification as more risky if they perceive a possibility of shocks like drought or market disruptions along the path.  -->

Several limitations of this study must be acknowledged.  We do not draw distinctions between diversification practices that require large up-front costs versus those that require continual maintenance, instead lumping practices together into a generalized framework.  Our model does not capture market dynamics resulting from feedbacks between production and consumption, but rather conceives of the system as a commodity market within which an individual grower's production does not influence the overarching market price.  We also do not consider ecosystem services and/or deleterious environmental effects that spill over from neighboring farmers' practices.  Each of these areas remains a potential avenue for future research.  


{>>probably a short conclusion paragraph<<}




\section{Methods}

We have developed a Markov Decision Process model (DFS-MDP) to simulate the decision factors faced by vegetable growers choosing the extent to which to adopt or invest in DEPs over time.  An MDP is an appropriate tool here because the scenario can be represented by an agent-environment pair in which the agent exists in a given state, interacts with the environment through consecutive actions, transitions probabilistically between states, and derives some reward therefrom (Fig \ref{fig:meth_mdp}A).  
 
 {>>make an updated version of this figure<<}
\begin{figure}[H]
	\centering
	\includegraphics[width=\textwidth]{methods_mdp.png}
	\caption{(A) Agent-environment interaction in an MDP. (B) PROBABLY GET RID OF THIS AS ITS SHOWN IN NEXT FIG (C) Schematic representation of our MDP model.}
	\label{fig:meth_mdp}
\end{figure}

The overarching goal of the model is to provide a mechanism for exploring the drivers behind DEP adoption, including the impact of ecosystem shocks, land tenure, and other decision factors.  Using a model-based approach, we aim to identify potential levers of change without relying on assumptions surrounding non-monotonic dynamics of prices or decisions.  While the model assumes that price is not a decreasing function of yield, we assume that at the state of the individual this does not qualitatively change.  Here we provide an overview of model elements and functions; full implementation details are provided in Appendix 1.  

The time step $t$ corresponds to a single growing season.  At each time step, the agent chooses an action $a$ representing the intensity of investment into diversification-enhancing practices.  The action space $A$ is characterized by an integer vector from 1 (no investment) to 10 (investing everything possible).  We assume that $A_s = A$ for all states.

The system state $s$ represents the degree to which the agent derives ecosystem services (ES)---such as soil productivity, water infiltration, climate resilience, etc.---from the DEPs they have implemented on their farm at $t$.  The state space $S$ is an integer vector from 1 to 10, with 10 being the maximum possible level of derived ecosystem services benefit.  

A probability matrix $P_a(s,s')$ describes the chance that the agent will transition from their current ES state $s$ to some state $s'$, given action $a$.  In our model, $s$ may only decrement by one, stay the same, or increment by one at each time step.  Higher-investment actions yield a higher probability of transitioning to a higher (i.e. more beneficial) ES state. The shape of the probability curve can be tuned to reflect, for example, diminishing marginal increases in the probability of stepping to the next ES state with each increment in $a$.  At the boundaries of the state space, an action cannot result in a state lower than $s_{min}$ or higher than $s_{max}$.  

The agent's reward $R$ is a function of the current ES state $s$ and the chosen action $a$.  Systems in higher ES states receive additional benefits $b_s$ from the ecosystem services provided by the DEPs they have adopted.  As above, depending on underlying contexts and assumptions, the benefit accrual function can be linear ($s \propto b$), or more complex, for example if we assume diminishing benefit returns as $s \to s_{max}$.  

Investment in DEPs also incurs costs $c_a$, either as a direct result of implementation (e.g. equipment, materials, and labor), opportunity costs (e.g. forgone yields due to reduced cultivated acreage or lost production efficiency), or both.  A higher level of investment will obviously result in higher costs, but, once again, we can either assume that $c$ scales linearly with $a$, or make the relationship more complex as the situation demands.  Populating the reward matrix is simply a matter of subtracting costs from benefits ($R(s,a) = b_s - c_a$).  


\subsection{System shocks}
We assume that the DEP investment choice can only increase or decrease an agent's ES state by---at most---one level at each time step.  However, stochastic environmental shocks---such as drought, flood, and disease---can decrease the derived ecosystem services benefit by a larger amount (Fig \ref{fig:meth_mdp}C).  We assume that the degree of ES state disruption when a shock occurs is proportional to the agent's current state (i.e. higher states are more resilient to shocks). 



\subsection{Solving the MDP}

To solve the MDP, we employ the value iteration---or backward induction---algorithm \cite{bellman1957markovian}.  This yields policy $\pi$, which codifies the optimal course of action for the agent given the initially-imposed environmental conditions.  In addition to the state transition matrix $P$ and reward matrix $R$, the algorithm also incorporates a myopic discounting factor $0 \leq \gamma \leq 1$, which describes the rate at which the agent's expected utility becomes less salient with each future time step, with $\gamma = 1$ representing no discounting.  For example, a vegetable grower would, in most cases, derive much more utility from high expected profits on next-year's crop than on the crop ten years in the future.  


\subsection{Model mathematical description (from Carl - needs to be integrated into the section)}

Mathematically, the farmer's decision model can be expressed as 

$$\max_{\lbrace a_t \rbrace} \mathbb{E} \left[ \sum_t^T U(x_t, a_t) \delta^t \right] $$

where $\lbrace a_t \rbrace$ is the set of available actions to be taken at each point in time $t$, $\delta$ is the discount rate, $\mathbb{E}$ the expectation operator, and $U(x_t, a_t)$ the utility which the farmer associates with being in state $x_t$ and taking action $a_t$ at time $t$. $T$ is the land tenure of the farm ($T = \infty$ if the farmer owns the land or otherwise expects to be able to farm the same land and thus benefit from the ecosystem services established there indefinitely)

We assume a simple model for the farmer's utility $U(x_t, a_t)$  as combination of the costs associated with adopting the diversified practice and the benefits derived from the ecosystem state (which is in turn influenced by the diversified practices or non-diversified practices adopted),

$$U(x_t, a_t) = b x_t  - c a_t$$
Where $x_t$ is the ecosystem state, $b$ the benefit associated, and $c a_t$ the cost of taking action $a_t$.  In general, more complicated nonlinear functions of both the ecosystem state and action are possible in this framework.  

The ecosystem state is also dynamic, evolving according to the transition function $f(x_t, a_t)$ 

$$x_{t+1} = f(x_t, a_t) := x_t + r \left(a_t - x_t \right)$$ 

This provides a minimal, one-parameter model in which the parameter $r$ sets the natural timescale at which the ecosystem can respond to a change in mangement practice.  



\subsection{Model implementation}

Our MDP was developed in R, using the MDPtoolbox library.  {>>ETC...<<}


\subsection{Parameterization from field observations and empirical data}

To establish the general parameters of our MDP model, our interdisciplinary research team began by exploring empirical evidence about the real-world drivers and distributions of farmers' adoption of diversification-enhancing practices.  We take a twofold approach, beginning with qualitative observations of trends within a relatively-small sample, and then testing hypotheses using results from a large-scale survey.  

\subsubsection{Original interviews}

Members of our team conducted interviews and on-farm observational studies of 20 organic lettuce growers and 8 technical assistance providers based in the California central coast region.  The sample was stratified to include growers across the spectrum of scale and market outlet.  Based on these studies, several important trends emerge.  Echoing previous research in this area, we find that adoption of DEPs tends to be bimodal; that is, growers are likely to either intensively-adopt many DEPs, or to adopt these practices minimally or not-at-all.  This may be explained by factors including limited capital availability to implement those DEPs with high up-front costs, food safety stipulations based on market outlet, risk attitude, and myopic discounting.  Land tenure---in terms of both length of time on the land, and whether land is leased versus owned---also appears to be a salient decision factor.  

\subsubsection{Survey dataset}

To evaluate the extent to which these observed adoption distributions hold quantitatively, we leverage a dataset of survey responses from 295 vegetable growers in Washington, Oregon, and California (!!CITE DATA SOURCE!!).  Table \ref{tab:deps_in_survey} shows the set of DEPs queried in the survey, with their adoption rates across the entire sample.  A histogram plotting the number of diversified practices used by each grower (Fig \ref{fig:dep_dist}A) confirms a bimodal distribution, with growers generally tending to either adopt zero DEPs---the most likely case---or else to adopt many, with six practices being the next-most-likely.

\begin{table}
	\centering
	\caption{Diversification-enhancing practices in the survey data}
	\begin{tabular}{lc}
		\hline
		\textbf{DEP Name}			& \textbf{Adoption rate} \\
		\hline
		Crop Rotation (3 or more)	& 63\% \\
		Cover Cropping				& 68\% \\
		Intercropping				& 52\% \\
		Insectary Plantings			& 61\% \\
		Riparian Buffers			& 84\% \\
		Border Plantings			& 45\% \\
		Compost or Manure			& 75\% \\
		Reduced Tillage				& 69\% \\
		\hline
	\end{tabular}
	\label{tab:deps_in_survey}
\end{table}

\begin{figure}
	\centering
	\includegraphics[width=.75\textwidth]{fig_dep_data.pdf}
	\caption{A. Bimodal distribution of DEP adoption in the sample.  B. Impact of land tenure on the probability of adopting at least one DEP.  }
	\label{fig:dep_dist}
\end{figure}

As discussed above, land tenure has often been shown to be a decision factor that impinges upon agricultural management practice adoption \cite{soule2000land, fraser2004land, richardson2015land, long2017hedgerow}.  Growers who have a long-term personal stake in the productive quality of their soil ecology are more likely to take the long view and invest in practices that will benefit them years down the line.  On the other hand, growers who are uncertain whether they will personally be farming a given parcel of land in future seasons may be less likely to adopt practices whose positive effects will not come to fruition in the short term.  To investigate the effect of land tenure on DEP adoption, we partition the dataset into growers who primarily own their land versus those who primarily lease it.  Figure \ref{fig:dep_dist}B shows that owners are about 20\% more likely than leasers to invest in at least one DEP.  


\subsubsection{Model parameters}

!!PROBABLY INCLUDE A BIT ABOUT HOW WE USED THE DATA TO PARAMETERIZE THE MODEL, INCLUDING A TABLE WITH THE FINAL PARAMETER VALUES WE DECIDED UPON.  THIS COULD ALSO BE LEFT FOR THE APPENDIX!!



\subsection{Experimental design}

!!MILLIE - DESCRIBE EXPERIMENTS WE CONDUCTED WITH THE MODEL IN DETAIL HERE!!


# References

\bibliography{alt_stable_states}

